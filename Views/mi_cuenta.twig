{% extends "layouts/base.twig" %}
{% block content %}
<section class="section">
    <div class="container">
        <h1 class="title">Mi Cuenta</h1>

        {% if user %}
            <div class="box">
                <p><strong>Nombre:</strong> {{ user.nombre|e }}</p>
                <p><strong>Email:</strong> {{ user.email|e }}</p>
                <p><strong>Rol:</strong>
                <span class="tag is-info">
                    {% if user.tipo == 'ADM' %}
                        Jefe de Comité
                    {% elseif user.tipo == 'AUT' %}
                        Autor
                    {% elseif user.tipo == 'REV' %}
                        Revisor
                    {% else %}
                        Desconocido
                    {% endif %}
                </span></p>
            </div>

            <div class="buttons">
                <a href="/editar_cuenta" class="button is-link">Editar información</a>
                <a href="/logout" class="button is-danger">Cerrar sesión</a>
            </div>
            
            <div class="mt-6">
                <h2 class="subtitle">Zona peligrosa</h2>
                <div class="box has-background-danger-light">
                    <p class="mb-3"><strong>Eliminar mi cuenta</strong></p>
                    <p class="mb-4">Esta acción es permanente y no se puede deshacer. Se eliminarán todos tus datos.</p>
                    
                    <form id="deleteAccountForm" action="/eliminar_cuenta" method="post">
                        <button type="button" class="button is-danger" onclick="confirmarEliminacion()">
                            Eliminar mi cuenta
                        </button>
                    </form>
                </div>
            </div>
            
            <script>
                function confirmarEliminacion() {
                    if (confirm('¿Estás seguro de que deseas eliminar tu cuenta? Esta acción no se puede deshacer.')) {
                        document.getElementById('deleteAccountForm').submit();
                    }
                }
            </script>
        {% else %}
            <div class="notification is-warning">
                No has iniciado sesión. <a href="/login">Haz clic aquí para ingresar</a>.
            </div>
        {% endif %}
    </div>
</section>
{% endblock %}